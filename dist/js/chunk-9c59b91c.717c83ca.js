(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9c59b91c"],{"15d7":function(t,e,i){"use strict";var a=i("7e7c"),n=i.n(a);n.a},4194:function(t,e,i){"use strict";var a=i("1c8b"),n=i("5dfd").find,s=i("258f"),r=i("ff9c"),c="find",o=!0,d=r(c);c in[]&&Array(1)[c]((function(){o=!1})),a({target:"Array",proto:!0,forced:o||!d},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),s(c)},"4ae9":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"record-detail",attrs:{flex:""}},[i("div",{staticClass:"operate",attrs:{flex:""}},[i("div",{staticClass:"back",attrs:{flex:""},on:{click:function(e){return t.$router.push("/record")}}},[i("svg-icon",{attrs:{name:"back"}}),i("span",[t._v("返回")])],1),i("single-button",{staticClass:"del-cache",attrs:{disabled:!t.hasCache,text:"删除草稿",size:.9},nativeOn:{click:function(e){return t.delCache(e)}}}),i("single-button",{staticClass:"use-cache",attrs:{disabled:!t.hasCache,text:"使用草稿",size:.9},nativeOn:{click:function(e){return t.useCache(e)}}}),i("single-button",{staticClass:"save-cache",attrs:{text:"保存草稿",size:.9},nativeOn:{click:function(e){return t.saveCache(e)}}}),i("loading-button",{attrs:{loading:t.saving.b,text:"上传",icon:"save"},nativeOn:{click:function(e){return t.save(e)}}}),t.saving.state?i("span",{staticClass:"state"},[t._v(t._s(t.saving.state))]):t._e()],1),i("div",{staticClass:"time",attrs:{flex:""}},[i("span",[i("span",[t._v("创建:")]),t._v(t._s(t._f("time")(t.info?t.info.time:0,!1)))]),i("span",[i("span",[t._v("修改:")]),t._v(t._s(t._f("time")(t.info?t.info.modifyTime:0,!1)))])]),i("div",{staticClass:"edit"},[i("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"images",attrs:{flex:""}},[i("span",{staticClass:"head",attrs:{flex:""}},[i("svg-icon",{attrs:{name:"picture"}}),t._v(" 封面 ")],1),t._l(t.info.images,(function(e,a){return i("div",{key:e,staticClass:"item",attrs:{flex:""}},[i("loading-img",{attrs:{src:e,size:[12,8],"data-viewer":!0}}),i("label",{staticClass:"bottom",attrs:{flex:""}},[i("input",{attrs:{"data-idx":a},domProps:{value:e},on:{focusout:t.editImg}}),i("single-button",{staticClass:"del-btn",attrs:{text:"删除"},nativeOn:{click:function(e){return t.delImg(a)}}})],1)],1)})),i("span",{staticClass:"add",attrs:{flex:""},on:{click:t.addImg}},[i("svg-icon",{attrs:{name:"add"}})],1)],2),i("label",{staticClass:"text"},[i("p",{attrs:{flex:""}},[i("svg-icon",{attrs:{name:"text"}}),t._v("文本:")],1),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})])])])},n=[],s=(i("b4fb"),i("4194"),i("ea69"),i("e18c"),i("1c2e"),i("af86"),i("6a61"),i("327b")),r=i("8e8da"),c=i("7081"),o=i("2a7d"),d=i("fa7d"),l=i("82b2"),u=i("dfaa"),f={name:"RecordDetail",components:{SingleButton:o["a"],LoadingImg:c["a"],LoadingButton:r["a"]},props:{record:{type:Array,default:function(){return[]}},inited:{type:Boolean,default:!1}},data:function(){return{saving:{b:!1,state:""},tempRecord:[],text:"",hasCache:!1,info:{},newInfo:{file:"",time:0,modifyTime:0,summary:"",images:[]}}},computed:{id:function(){return this.$route.params.id},gitUtil:function(){return this._gitUtil()}},inject:["_gitUtil"],watch:{"$props.inited":function(){this.init()}},created:function(){this.hasCache=null!==Object(u["c"])("record-".concat(this.id))},beforeRouteEnter:function(t,e,i){i((function(t){t.$props.inited&&t.init()}))},methods:{init:function(){var t=this;console.log("init"),this.info=JSON.parse(JSON.stringify("new"===this.id?this.newInfo:this.record.find((function(e){return e.file===t.id}))||this.newInfo)),"new"!==this.id?Object(d["a"])("".concat(l["b"],"/record/").concat(this.id,".txt")).then((function(e){e[0]?t.text=e[1]:t.$message.error(Object(d["c"])(e[1]))})):this.text=""},delCache:function(){Object(u["a"])("record-".concat(this.id)),Object(u["a"])("record-".concat(this.id,"-text")),this.$message.success("草稿已删除"),this.hasCache=!1},useCache:function(){this.info=JSON.parse(Object(u["c"])("record-".concat(this.id))),this.text=Object(u["c"])("record-".concat(this.id,"-text")),this.$message.success("草稿已加载")},saveCache:function(){Object(u["d"])("record-".concat(this.id),JSON.stringify(this.info)),Object(u["d"])("record-".concat(this.id,"-text"),this.mdText),this.$message.success("草稿已保存"),this.hasCache=!0},delImg:function(t){this.info.images.splice(t,1)},editImg:function(t){this.info.images.splice(parseInt(t.target.getAttribute("data-idx")),1,t.target.value)},addImg:function(){this.info.images.push("")},save:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var i,a,n,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.saving.b){e.next=2;break}return e.abrupt("return");case 2:if(!t.gitUtil){e.next=35;break}if(i=t.info,i.images.length){e.next=6;break}return e.abrupt("return",t.$message.warning("封面不能为空!"));case 6:t.saving={b:!0,state:"保存中..."},i.summary=t.text.substr(0,30)+(t.text.length>=30?"... ...":""),a=(new Date).getTime(),i.modifyTime=a,"new"!==t.id?a=t.id:(i.time=a,i.file=a.toString(),t.record.push(JSON.parse(JSON.stringify(i)))),e.t0=regeneratorRuntime.keys(t.record);case 12:if((e.t1=e.t0()).done){e.next=19;break}if(n=e.t1.value,t.record[n].file!==t.id){e.next=17;break}return t.record[n]=i,e.abrupt("break",19);case 17:e.next=12;break;case 19:return t.saving.state="更新:record.json",Object(d["d"])(t.record),e.next=23,t.gitUtil.updateJsonFile("record.json",t.record);case 23:if(s=e.sent,!s[0]){e.next=31;break}return e.next=27,t.gitUtil.updateRecord({file:a,txt:t.text},t.saving);case 27:r=e.sent,r[0]?(t.$message.success("上传成功!"),window.location.reload()):t.$message.error(Object(d["c"])(r[1])),e.next=32;break;case 31:t.$message.error(Object(d["c"])(s[1]));case 32:t.saving={b:!1,state:""},e.next=37;break;case 35:t.$message.warning("请先登录!"),t.$emit("login");case 37:case"end":return e.stop()}}),e)})))()}}},g=f,h=(i("15d7"),i("9ca4")),p=Object(h["a"])(g,a,n,!1,null,"1b3ccd71",null);e["default"]=p.exports},7081:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"loading-img",style:t.calcStyle},[i("img",{class:{failed:t.failed},attrs:{"data-viewer":t.dataViewer,src:t.srcNow,alt:"img"},on:{load:t.loaded,error:t.errored,click:t.reload}}),t.loading?i("span",{attrs:{flex:""}},[i("svg-icon",{attrs:{name:"loading"}})],1):t._e()])},n=[],s=i("8f7d"),r=i.n(s),c={name:"LoadingImg",props:{src:{type:String,default:""},size:{type:Array,default:function(){return[8,8]}},dataViewer:{type:Boolean,default:!1}},data:function(){return{srcNow:this.src,loading:!0,failed:!1}},watch:{"$props.src":function(){this.srcNow=this.$props.src,this.failed=!1,this.loading=!0}},computed:{calcStyle:function(){var t={};return this.size[0]>0&&(t.width="".concat(this.size[0],"rem")),this.size[1]>0&&(t.height="".concat(this.size[1],"rem")),t}},methods:{loaded:function(){this.loading=!1},errored:function(){this.loading=!1,this.failed=!0,this.srcNow=r.a},reload:function(){this.failed&&(this.loading=!0,this.failed=!1,this.srcNow=this.src)}}},o=c,d=(i("c66d"),i("9ca4")),l=Object(d["a"])(o,a,n,!1,null,"509476a2",null);e["a"]=l.exports},"7e7c":function(t,e,i){},"8f7d":function(t,e,i){t.exports=i.p+"img/error.846eeb1f.jpg"},9302:function(t,e,i){"use strict";var a=i("1c8b"),n=i("692f"),s=i("da10"),r=i("d7e1"),c=[].join,o=n!=Object,d=r("join",",");a({target:"Array",proto:!0,forced:o||!d},{join:function(t){return c.call(s(this),void 0===t?",":t)}})},c260:function(t,e,i){},c66d:function(t,e,i){"use strict";var a=i("c260"),n=i.n(a);n.a},dfaa:function(t,e,i){"use strict";i.d(e,"d",(function(){return s})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return d}));i("f3dd"),i("0a51"),i("b4fb"),i("9302"),i("77ad"),i("053b"),i("e18c"),i("e35a"),i("1c2e"),i("5e9f");var a=i("19d5"),n=i("8b68");function s(t,e){window.localStorage.setItem("cache-"+t,e)}function r(t){return window.localStorage.getItem("cache-"+t)}function c(t){return window.localStorage.removeItem("cache-"+t)}var o=i("c247");function d(t){if("update"===o.rss.timeBy){var e=t.slice();e.sort((function(t,e){return t.modifyTime>e.modifyTime?-1:1})),t=e}t=t.slice(0,o.rss.count);var i=location.origin;function s(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function r(t,e,i){var a=c.createElement(t);return e&&(e=e.toString(),a.innerHTML=i?e:s(e)),a}var c=(new DOMParser).parseFromString('<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"></rss>',"application/xml"),d=c.getElementsByTagName("rss")[0],l=r("channel","");l.appendChild(r("title",o.rss.title)),l.appendChild(r("link",i)),l.appendChild(r("description",o.rss.description)),l.appendChild(r("ttl",o.rss.ttl)),l.appendChild(r("category",o.rss.categories)),l.appendChild(r("lastBuildDate",Object(n["a"])((new Date).getTime(),!1))),l.appendChild(r("language","zh-cn"));var u,f=Object(a["a"])(t);try{for(f.s();!(u=f.n()).done;){var g=u.value,h=r("item");h.appendChild(r("author",o.owner)),h.appendChild(r("title",g.name)),h.appendChild(r("link",i+"/article/"+g.file)),h.appendChild(r("description","\n            <h3><b>".concat(g.name,'</b></h3>\n            <span style="display: block">').concat(g.summary,'</span>\n            <img src="').concat(g.cover,'" alt=""/>\n        '),!0)),h.appendChild(r("category",g.tags.join("/"))),h.appendChild(r("pubDate",Object(n["a"])("create"===o.rss.timeBy?g.time:g.modifyTime,!1))),h.appendChild(r("guid",g.time)),l.appendChild(h)}}catch(p){f.e(p)}finally{f.f()}return d.appendChild(l),(new XMLSerializer).serializeToString(c)}}}]);